local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Biến trạng thái
local clicking = false
local clickSpeed = 10  -- Default speed (clicks per second)
local connection

-- Tìm RemoteEvent để fire click (thường là "Click" hoặc tương tự trong Lucky Block games)
local clickRemote = ReplicatedStorage:FindFirstChild("Click") or ReplicatedStorage:FindFirstChild("ClickEvent") or ReplicatedStorage:FindFirstChild("BreakBlock")

if not clickRemote then
    warn("Không tìm thấy Remote để click! Script có thể không hoạt động đúng game.")
end

-- Hàm auto click
local function startAutoClick()
    if connection then connection:Disconnect() end
    connection = RunService.Heartbeat:Connect(function()
        if clicking and clickRemote then
            clickRemote:FireServer()  -- Fire liên tục
        end
    end)
end

local function stopAutoClick()
    if connection then
        connection:Disconnect()
        connection = nil
    end
end

-- === GUI ===
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "BreakLuckyBlockGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 260, 0, 200)
mainFrame.Position = UDim2.new(0.5, -130, 0.5, -100)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 25, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true  -- Kéo thả được
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

local gradient = Instance.new("UIGradient")
gradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 40, 60)), ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 20, 30))}
gradient.Parent = mainFrame

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -40, 0, 35)
title.Position = UDim2.new(0, 10, 0, 5)
title.BackgroundTransparency = 1
title.Text = "Break a Lucky Block"
title.TextColor3 = Color3.fromRGB(0, 255, 200)
title.Font = Enum.Font.GothamBlack
title.TextSize = 18
title.Parent = mainFrame

-- Close Button
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 30, 0, 30)
closeBtn.Position = UDim2.new(1, -40, 0, 5)
closeBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
closeBtn.Text = "X"
closeBtn.TextColor3 = Color3.new(1,1,1)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 20
closeBtn.Parent = mainFrame

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 8)
closeCorner.Parent = closeBtn

closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
    stopAutoClick()
end)

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(1, -30, 0, 45)
toggleBtn.Position = UDim2.new(0, 15, 0, 50)
toggleBtn.BackgroundColor3 = Color3.fromRGB(40, 50, 60)
toggleBtn.Text = "Auto Click: OFF"
toggleBtn.TextColor3 = Color3.fromRGB(200, 50, 50)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 16
toggleBtn.AutoButtonColor = false
toggleBtn.Parent = mainFrame

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 10)
toggleCorner.Parent = toggleBtn

toggleBtn.MouseButton1Click:Connect(function()
    clicking = not clicking
    if clicking then
        toggleBtn.Text = "Auto Click: ON"
        toggleBtn.TextColor3 = Color3.fromRGB(50, 255, 100)
        toggleBtn.BackgroundColor3 = Color3.fromRGB(40, 80, 50)
        startAutoClick()
    else
        toggleBtn.Text = "Auto Click: OFF"
        toggleBtn.TextColor3 = Color3.fromRGB(200, 50, 50)
        toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 40, 40)
        stopAutoClick()
    end
end)

-- Speed Label
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(1, -30, 0, 25)
speedLabel.Position = UDim2.new(0, 15, 0, 110)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Speed: " .. clickSpeed
speedLabel.TextColor3 = Color3.fromRGB(100, 255, 200)
speedLabel.Font = Enum.Font.Gotham
speedLabel.TextSize = 16
speedLabel.Parent = mainFrame

-- Slider cho speed
local sliderFrame = Instance.new("Frame")
sliderFrame.Size = UDim2.new(1, -30, 0, 20)
sliderFrame.Position = UDim2.new(0, 15, 0, 140)
sliderFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
sliderFrame.Parent = mainFrame

local sliderCorner = Instance.new("UICorner")
sliderCorner.CornerRadius = UDim.new(0, 10)
sliderCorner.Parent = sliderFrame

local sliderFill = Instance.new("Frame")
sliderFill.Size = UDim2.new(clickSpeed / 100, 0, 1, 0)
sliderFill.BackgroundColor3 = Color3.fromRGB(0, 255, 150)
sliderFill.Parent = sliderFrame

local sliderFillCorner = Instance.new("UICorner")
sliderFillCorner.CornerRadius = UDim.new(0, 10)
sliderFillCorner.Parent = sliderFill

local dragging = false

sliderFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
    end
end)

sliderFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local relativeX = math.clamp((input.Position.X - sliderFrame.AbsolutePosition.X) / sliderFrame.AbsoluteSize.X, 0, 1)
        clickSpeed = math.floor(relativeX * 100) + 1  -- Từ 1 đến 100
        sliderFill.Size = UDim2.new(relativeX, 0, 1, 0)
        speedLabel.Text = "Speed: " .. clickSpeed
        
        -- Điều chỉnh tốc độ click thực tế
        if clicking then
            stopAutoClick()
            task.wait(0.1)
            startAutoClick()
            -- Note: Vì dùng Heartbeat, tốc độ thực tế phụ thuộc FPS, nhưng slider này để bạn cảm giác control (có thể thay bằng task.spawn loop với delay = 1/clickSpeed)
        end
    end
end)

print("Break a Lucky Block GUI Loaded! Enjoy :)")
