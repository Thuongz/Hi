-- MM2 Auto Farm t·ª´ Onyx Hub (ch·ª©c nƒÉng ch√≠nh: farm coins, godlies, event items)
-- Th√™m v√†o Rayfield menu. Copy paste v√†o executor (KRNL, Fluxus, etc.)
-- **C·∫¢NH B√ÅO**: C√≥ th·ªÉ b·ªã ban acc Roblox. D√πng alt acc!

getgenv().AutoFarmEnabled = false
getgenv().WalkSpeed = 16
getgenv().AntiAFK = false

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- Auto Farm Loop (farm nearest coin/gun/knife/event item)
spawn(function()
    while true do
        wait(0.05)
        if getgenv().AutoFarmEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            pcall(function()
                local char = player.Character
                local root = char.HumanoidRootPart
                local coins = {}
                
                -- T√¨m t·∫•t c·∫£ items: coins, eggs, beachball, snowtoken, godlies, guns
                for _, v in pairs(workspace:GetChildren()) do
                    local name = string.lower(v.Name)
                    if (name:find("coin") or name:find("egg") or name:find("beachball") or name:find("snowtoken") or 
                        name:find("candy") or name:find("knife_") or name:find("gun")) and 
                        v:IsA("Model") and v.PrimaryPart then
                        local dist = (root.Position - v.PrimaryPart.Position).Magnitude
                        if dist < 500 then  -- Gi·ªõi h·∫°n range ƒë·ªÉ tr√°nh lag
                            table.insert(coins, {model = v, dist = dist, pos = v.PrimaryPart.CFrame})
                        end
                    end
                end
                
                -- Sort nearest first
                table.sort(coins, function(a, b) return a.dist < b.dist end)
                
                if #coins > 0 then
                    root.CFrame = coins[1].pos * CFrame.new(0, 5, 0)  -- Teleport l√™n tr√™n item
                end
            end)
        end
        
        -- WalkSpeed
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = getgenv().WalkSpeed
        end
    end
end)

-- Anti AFK
spawn(function()
    while true do
        wait(60)  -- M·ªói 1 ph√∫t
        if getgenv().AntiAFK then
            local VirtualUser = game:GetService('VirtualUser')
            game:GetService('Players').LocalPlayer.Idled:Connect(function()
                VirtualUser:CaptureController()
                VirtualUser:ClickButton2(Vector2.new())
            end)
        end
    end
end)

-- Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Onyx Hub - Auto Farm",
    LoadingTitle = "MM2 Farm",
    LoadingSubtitle = "T·ª´ gumanba Onyx",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "OnyxMM2",
        FileName = "AutoFarm"
    },
    Discord = {
        Enabled = false
    },
    KeySystem = false
})

local FarmTab = Window:CreateTab("ü§ñ Auto Farm", 4483362458)
local FarmSection = FarmTab:CreateSection("Ch·ª©c nƒÉng Farm")

FarmTab:CreateToggle({
    Name = "Auto Farm (Coins/Godlies/Items/Event)",
    CurrentValue = false,
    Flag = "FarmToggle",
    Callback = function(Value)
        getgenv().AutoFarmEnabled = Value
        if Value then
            Rayfield:Notify({
                Title = "Auto Farm ON",
                Content = "Farm nearest items t·ª± ƒë·ªông!",
                Duration = 3,
                Image = 4483362458
            })
        else
            Rayfield:Notify({
                Title = "Auto Farm OFF",
                Content = "D·ª´ng farm.",
                Duration = 2
            })
        end
    end
})

FarmTab:CreateToggle({
    Name = "Anti AFK",
    CurrentValue = false,
    Flag = "AntiAFKToggle",
    Callback = function(Value)
        getgenv().AntiAFK = Value
    end
})

local SpeedSection = FarmTab:CreateSection("T·ªëc ƒë·ªô")

FarmTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "WalkSpeedSlider",
    Callback = function(Value)
        getgenv().WalkSpeed = Value
    end
})

local MiscTab = Window:CreateTab("‚öôÔ∏è Misc")
local MiscSection = MiscTab:CreateSection("Kh√°c")

MiscTab:CreateButton({
    Name = "Rejoin Server (n·∫øu full bag)",
    Callback = function()
        game:GetService("TeleportService"):Teleport(game.PlaceId, player)
    end
})

MiscTab:CreateButton({
    Name = "Copy Script Loadstring",
    Callback = function()
        setclipboard('loadstring(game:HttpGet("https://raw.githubusercontent.com/gumanba/Scripts/main/mm2"))()')
        Rayfield:Notify({
            Title = "Copied!",
            Content = "Onyx Hub loadstring ƒë√£ copy.",
            Duration = 3
        })
    end
})

Rayfield:Notify({
    Title = "Onyx Auto Farm Loaded!",
    Content = "Toggle Auto Farm ƒë·ªÉ b·∫Øt ƒë·∫ßu. Farm coins/godlies/event items t·ª± ƒë·ªông nh∆∞ Onyx Hub.",
    Duration = 6,
    Image = 4483362458,
    Actions = {
        Ignore = {
            Name = "OK!",
            Callback = function() end
        }
    }
})
