local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "MM2 Auto Farm",
   LoadingTitle = "Loading...",
   LoadingSubtitle = "Simple Farm System",
   ConfigurationSaving = { Enabled = false },
   KeySystem = false
})

local Tab = Window:CreateTab("Farm", 4483362458)

getgenv().AutoFarm = false

Tab:CreateToggle({
   Name = "Auto Farm Coins",
   CurrentValue = false,
   Callback = function(v) 
      getgenv().AutoFarm = v 
      if v then
         Rayfield:Notify({
            Title = "Auto Farm",
            Content = "Đã bật auto farm",
            Duration = 2
         })
      end
   end
})

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local player = Players.LocalPlayer

-- TELEPORT FIX
local function teleport(pos)
   local char = player.Character
   if not char then return false end
   
   local hrp = char:FindFirstChild("HumanoidRootPart")
   if not hrp then return false end
   
   local success = false
   
   pcall(function()
      hrp.CFrame = CFrame.new(pos.X, pos.Y + 3, pos.Z)
      success = true
   end)
   
   return success
end

-- TÌM COINS
local function getCoins()
   local coins = {}
   local container = Workspace:FindFirstChild("CoinContainer")
   
   if container then
      for _, server in pairs(container:GetChildren()) do
         if server.Name == "Coin_Server" then
            local coin = server:FindFirstChild("Coin")
            if coin and coin:IsA("BasePart") then
               table.insert(coins, coin)
            end
         end
      end
   end
   
   return coins
end

-- AUTO FARM LOOP
task.spawn(function()
   while true do
      task.wait(0.5)
      
      if not getgenv().AutoFarm then continue end
      if not player.Character then continue end
      if player.Character.Humanoid.Health <= 0 then continue end
      
      local coins = getCoins()
      if #coins == 0 then continue end
      
      -- Lấy coin đầu tiên
      local coin = coins[1]
      
      -- Teleport đến coin
      if teleport(coin.Position) then
         -- Chờ 1 giây
         task.wait(1)
         
         -- Thu thập coin bằng firetouch
         pcall(function()
            local hrp = player.Character.HumanoidRootPart
            if hrp then
               firetouchinterest(hrp, coin, 0)
               task.wait(0.05)
               firetouchinterest(hrp, coin, 1)
            end
         end)
         
         -- Chờ trước khi farm tiếp
         task.wait(0.5)
      end
   end
end)

print("✅ Auto Farm Loaded")
