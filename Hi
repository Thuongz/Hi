-- MM2 Auto Farm Coin & EXP v·ªõi Rayfield Menu
-- FIX 100% - KH√îNG CHECK N·ªÆA, CH·∫†Y LU√îN ·ªû M·ªåI N∆†I
-- Hi·ªÉn th·ªã PlaceId & UniverseId ƒë·ªÉ confirm b·∫°n ƒëang ·ªü MM2 ch√≠nh (Universe: 66654135)
-- Toggle Auto Farm Coins & GodMode qua GUI ƒë·∫πp

local PlaceId = game.PlaceId
local UniverseId = game.GameId
local MM2Universe = 66654135

-- C·∫£nh b√°o n·∫øu kh√¥ng ph·∫£i MM2 (nh∆∞ng v·∫´n ch·∫°y)
if UniverseId ~= MM2Universe then
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "‚ö†Ô∏è C·∫£nh b√°o";
        Text = "Kh√¥ng ph·∫£i MM2 ch√≠nh th·ª©c (Universe: " .. UniverseId .. ")!\nC√≥ th·ªÉ farm kh√¥ng work.";
        Duration = 7;
    })
end

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "MM2 Auto Farm by Grok",
    LoadingTitle = "ƒêang load...",
    LoadingSubtitle = "Auto Coin & EXP - FIX 100%",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "MM2FarmGrok",
        FileName = "RayfieldConfig"
    },
    KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458) -- Icon MM2

-- Hi·ªÉn th·ªã ID hi·ªán t·∫°i ƒë·ªÉ confirm
Tab:CreateLabel("üìç PlaceId: " .. PlaceId)
Tab:CreateLabel("üåå UniverseId: " .. UniverseId .. " (MM2: 66654135)")

-- Variables
getgenv().AutoFarmCoins = false
getgenv().GodMode = false
local player = game.Players.LocalPlayer
local GodModeConnection

-- Function apply GodMode
local function applyGodMode(char)
    local humanoid = char:WaitForChild("Humanoid", 5)
    if humanoid and getgenv().GodMode then
        humanoid.MaxHealth = math.huge
        humanoid.Health = math.huge
    end
end

-- Function remove GodMode
local function removeGodMode(char)
    local humanoid = char:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.MaxHealth = 100
        humanoid.Health = math.huge -- Keep full health but normal max
    end
end

-- Auto Farm Coins Loop (t·ªëi ∆∞u h∆°n, ch·ªâ farm khi c√≥ coin)
spawn(function()
    while wait(0.1) do
        if getgenv().AutoFarmCoins and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            for _, v in pairs(workspace:GetDescendants()) do
                if v.Name == "CoinContainer" and v:FindFirstChild("Coin_Server") and v.Coin_Server:FindFirstChild("Coin") then
                    local hrp = player.Character.HumanoidRootPart
                    hrp.CFrame = v.Coin_Server.Coin.CFrame * CFrame.new(0, 3, 0)
                    firetouchinterest(hrp, v.Coin_Server.Coin, 0)
                    wait()
                    firetouchinterest(hrp, v.Coin_Server.Coin, 1)
                end
            end
        end
    end
end)

-- GodMode Toggle
Tab:CreateToggle({
    Name = "GodMode (Farm EXP an to√†n)",
    CurrentValue = false,
    Flag = "GodModeToggle",
    Callback = function(Value)
        getgenv().GodMode = Value
        if Value then
            if GodModeConnection then GodModeConnection:Disconnect() end
            GodModeConnection = player.CharacterAdded:Connect(applyGodMode)
            if player.Character then applyGodMode(player.Character) end
            Rayfield:Notify({Title = "GodMode", Content = "B·∫≠t!", Duration = 2})
        else
            if GodModeConnection then GodModeConnection:Disconnect() end
            GodModeConnection = nil
            if player.Character then removeGodMode(player.Character) end
            Rayfield:Notify({Title = "GodMode", Content = "T·∫Øt!", Duration = 2})
        end
    end
})

-- Auto Farm Coins Toggle
Tab:CreateToggle({
    Name = "Auto Farm Coins (TP + Collect)",
    CurrentValue = false,
    Flag = "AutoFarmCoinsToggle",
    Callback = function(Value)
        getgenv().AutoFarmCoins = Value
        Rayfield:Notify({
            Title = "Auto Farm Coins";
            Content = Value and "B·∫≠t!" or "T·∫Øt!";
            Duration = 2
        })
    end
})

-- Info
Tab:CreateLabel("üí° Farm EXP: GodMode + s·ªëng s√≥t round")
Tab:CreateLabel("ü™ô Farm Coins: TP auto collect coin spawn")

-- Buttons
Tab:CreateButton({
    Name = "Rejoin Server (Hi·ªán T·∫°i)",
    Callback = function()
        game:GetService("TeleportService"):Teleport(PlaceId, player)
    end
})

Tab:CreateButton({
    Name = "Go to MM2 Classic (142823291)",
    Callback = function()
        game:GetService("TeleportService"):Teleport(142823291, player)
    end
})

Tab:CreateButton({
    Name = "Go to MM2 Disguises (335132309)",
    Callback = function()
        game:GetService("TeleportService"):Teleport(335132309, player)
    end
})

-- Loaded
local loadedText = "‚úÖ Loaded! | Place: " .. PlaceId .. " | Universe: " .. UniverseId
if UniverseId == MM2Universe then
    loadedText = loadedText .. " (MM2 CH√çNH TH·ª®C!)"
end
Rayfield:Notify({
    Title = "‚úÖ Loaded 100%!";
    Content = loadedText;
    Duration = 6;
    Image = 4483362458
})

-- Auto apply GodMode
player.CharacterAdded:Connect(function()
    wait(1)
    if getgenv().GodMode then applyGodMode(player.Character) end
end)
